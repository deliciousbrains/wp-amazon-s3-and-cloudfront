!function(a){a(document).ready(function(){function b(){d.html('<li class="loading">'+d.attr("data-working")+"</li>");var b={action:"as3cf-get-buckets",_nonce:as3cf_i18n.get_buckets_nonce};a.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:b,error:function(a,b,c){d.html(""),alert(as3cf_i18n.get_buckets_error+c)},success:function(b){d.html(""),"undefined"!=typeof b.success?(b.can_write===!1&&a(".as3cf-can-write-error").show(),a(b.buckets).each(function(a,c){var e=c.Name==b.selected?"selected":"";d.append('<li><a class="'+e+'" href="#" data-bucket="'+c.Name+'"><span class="bucket"><span class="dashicons dashicons-portfolio"></span> '+c.Name+'</span><span class="spinner"></span></span></a></li>')})):alert(as3cf_i18n.get_buckets_error+b.error)}})}function c(){}a(".as3cf-settings").each(function(){var c=a(this),d=a(".as3cf-bucket-list"),e=c.find(".as3cf-create-bucket-form");if(e.length){var f=e.find("button"),g=f.text();e.on("submit",function(c){c.preventDefault(),d.addClass("saving"),f.text(f.attr("data-working")),f.prop("disabled",!0);var h=e.find('input[name="bucket_name"]').val(),i={action:"as3cf-create-bucket",bucket_name:h,_nonce:as3cf_i18n.create_bucket_nonce};a.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:i,error:function(a,b,c){f.text(g),alert(as3cf_i18n.create_bucket_error+c)},success:function(c){f.text(g),f.prop("disabled",!1),"undefined"!=typeof c.success?(a(".updated").show(),a(".as3cf-settings").addClass("as3cf-has-bucket"),a(".as3cf-active-bucket").text(h),e.find('input[name="bucket_name"]').val(""),a(".as3cf-bucket-list a").removeClass("selected"),b(),d.removeClass("saving")):alert(as3cf_i18n.create_bucket_error+c.error)}})})}var h=c.find(".as3cf-change-bucket");h.length&&h.on("click",function(b){b.preventDefault(),a(".updated").hide(),a(".as3cf-settings").removeClass("as3cf-has-bucket"),a(".as3cf-active-bucket").html&&a(".as3cf-cancel-bucket-select-wrap").show(),a(".as3cf-bucket-list a.selected").length&&a(".as3cf-bucket-list").scrollTop(a(".as3cf-bucket-list a.selected").position().top-50)});var i=c.find(".as3cf-refresh-buckets");i.length&&i.on("click",function(a){a.preventDefault(),b()});var j=c.find(".as3cf-cancel-bucket-select");j.length&&j.on("click",function(b){b.preventDefault(),a(".as3cf-settings").addClass("as3cf-has-bucket")})});var d=a(".as3cf-bucket-list");d.on("click","a",function(b){if(b.preventDefault(),a(this).hasClass("selected"))return void a(".as3cf-settings").addClass("as3cf-has-bucket");var c=this;a(".as3cf-bucket-list a").removeClass("selected"),a(c).addClass("selected"),d.addClass("saving"),a(c).find(".spinner").show();var e=a(c).attr("data-bucket"),f={action:"as3cf-save-bucket",bucket_name:e,_nonce:as3cf_i18n.save_bucket_nonce};a.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:f,error:function(a,b,c){d.removeClass("saving"),alert(as3cf_i18n.save_bucket_error+c)},success:function(b){a(c).find(".spinner").hide(),d.removeClass("saving"),"undefined"!=typeof b.success?(a(".as3cf-settings").addClass("as3cf-has-bucket"),a(".as3cf-active-bucket").text(e),a(".updated").show()):alert(as3cf_i18n.save_bucket_error+b.error)}})}),a(".as3cf-switch").on("click","span",function(){if(!a(this).hasClass("checked")&&!a(this).parent().hasClass("disabled")){var b=a(this).parent().attr("id");a("#"+b+" span").toggleClass("checked");var c=a("#"+b+" span.on").hasClass("checked"),d=a("#"+b).data("checkbox"),e=a("input#"+d);e.attr("checked",c),e.trigger("change")}}),a(".as3cf-settings").on("change",".sub-toggle",function(){var b=a(this).attr("id");a(".as3cf-setting."+b).toggleClass("hide")}),a(".as3cf-domain").on("change",'input[type="radio"]',function(){var b=a('input:radio[name="domain[]"]:checked').val();"cloudfront"==b&&a(".as3cf-setting.cloudfront").hasClass("hide")?a(".as3cf-setting.cloudfront").removeClass("hide"):a(".as3cf-setting.cloudfront").addClass("hide")}),a(".as3cf-settings").on("change","#force-ssl",function(){if(a(".subdomain-wrap").toggleClass("disabled"),a(this).is(":checked")){var b=a('input:radio[name="domain[]"]:checked').val();"subdomain"==b&&a('input[name="domain[]"][value="path"]').attr("checked",!0),a(".subdomain-wrap input").attr("disabled",!0)}else a(".subdomain-wrap input").removeAttr("disabled")}),a(".configure-url").on("click",'input[type="radio"], input[type="checkbox"]',function(){c()}),a(".configure-url").on("change",'input[type="text"]',function(){c()})})}(jQuery);